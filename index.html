<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chainlet Orbits: Topological Address Embedding for Blockchain</title>
    <style>
        body {
            text-align: center;
        }
        p, ul, ol, figure {
            text-align: justify;
            margin: 0 auto;
            width: 80%;
        }
        h1, h2, h3, h4 {
            text-align: center;
        }
        figure {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        figcaption {
            margin-top: 10px;
            font-style: italic;
        }
    </style>
    <!-- MathJax for LaTeX Math Rendering -->
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js">
    </script>
</head>
<body>
    <h1>Chainlet Orbits: Topological Address Embedding for Blockchain</h1>
    <h2>Abstract</h2>
    <p>The rise of cryptocurrencies like Bitcoin has not only increased trade volumes but also broadened the use of graph machine learning techniques, such as address embeddings, to analyze transactions and decipher user patterns. Traditional detection methods rely on simple heuristics and extensive data gathering, while more advanced Graph Neural Networks encounter challenges such as scalability, poor interpretability, and label scarcity in massive blockchain transaction networks.</p>
    <p>To overcome the computational and interpretability limitations of existing techniques, we introduce a topological approach, Chainlet Orbits, which embeds blockchain addresses by leveraging their topological characteristics in temporal transactions. We employ our innovative address embeddings to investigate financial behavior and e-crime in the Bitcoin, Litecoin, and Ethereum networks, focusing on distinctive substructures that arise from user behavior. In node classification experiments, our model demonstrates exceptional performance when compared to GNN-based approaches. Furthermore, our approach embeds all daily nodes of the largest blockchain transaction network, Bitcoin, and creates explainable machine learning models in less than 17 minutes, which takes days for GNN-based approaches.</p>

    <h2>Chainlets and Orbits</h2>
    <p>The temporal position of an address node within a directed transaction graph determines its structural role, referred to as an <em>orbit</em>, which can be leveraged in supervised learning tasks. Our primary objective is to establish these roles and utilize them in graph machine learning models. Orbits apply to UTXO blockchains naturally because a one-time-use-only transaction appears in the heterogeneous graph as a node, which allows ordering address nodes. For this reason, we use UTXO networks to define orbits. We extend our definition to account-based blockchains by using the temporal order.</p>
    <figure>
        <img src="figs/rsMostFreqpattern.png" alt="Directed Bitcoin Network Graph" style="width: 60%;">
        <figcaption>By analyzing transaction patterns within the directed Bitcoin network, we identify specific address behaviors (circular nodes) in transactions (rectangular nodes), assigning structural roles as orbits. An e-crime address (red, striped) demonstrates orbits 9, 13, and 14, typical for ransomware transactions.</figcaption>
    </figure>

    <p>We model the UTXO network with a graph \( G = (V, E, B) \) from a set of transactions \( TX \) and input and output addresses in \( TX \).</p>
    <p>On \( G \), \( V \) is a set of nodes, and \( E \subseteq V \times V \) is a set of edges. \( B = \{ \textbf{Address}, \textbf{Transaction} \} \) represents the set of node types. A node \( u \in V \) has a node type \( \phi(u) \in B \).</p>
    <p>For each edge \( e_{uv} \in E \) between adjacent nodes \( u \) and \( v \), we have \( \phi(u) \neq \phi(v) \). In other words, there is no edge between the same node types (Transaction → Transaction or Address → Address), and an edge \( e \in E \) represents a coin transfer between an address node and a transaction node.</p>

    <p><strong>Chainlets.</strong> Chainlets have been introduced to define position-invariant versions of transaction patterns. The key idea of the chainlet approach is to offer a lossless summary of all transactions by assigning two indices \( i, o \) in the \([0, n]\) range to each transaction with respect to its input and output addresses. A Bitcoin subgraph \( G' = (V', E', B) \) is a <em>subgraph</em> of \( G \), if \( V' \subseteq V \) and \( E' \subseteq E \). If \( G' = (V', E', B) \) is a subgraph of \( G \) and \( E' \) contains all edges \( e_{uv} \in E \) such that \( (u, v) \in V' \), then \( G' \) is called an <em>induced subgraph</em> of \( G \). Two graphs \( G' = (V', E', B) \) and \( G'' = (V'', E'', B) \) are called <em>isomorphic</em> if there exists a bijection \( h: V' \to V'' \) such that all node pairs \( u, v \in V' \) are adjacent in \( G' \) if and only if \( h(u) \) and \( h(v) \) are adjacent in \( G'' \).</p>

    <p><strong>\( k \)-chainlet.</strong> Let \( k \)-chainlet \( C_k \) in \( G \) be the subgraph of \( G \) containing \( k \) subsequent transaction nodes, all output nodes of these \( k \) transaction nodes, and all input nodes of the first transaction.</p>

    <p>A 1-chainlet lists a transaction node with its input and output addresses. Figure 2 shows a 2-chainlet; transactions \( t_1 \) and \( t_2 \) share the common address \( a_1 \). A \( k \)-chainlet where \( k > 1 \) has a natural ordering of transactions because transactions are ordered in blocks, which, in turn, are ordered in a blockchain. This natural order allows us to assign roles to an address depending on where the address appears in a 2-chainlet. In the next section, we will count address roles and list them as address orbits.</p>

    <p><strong>Chainlet Classes.</strong> Let \( A_k(G) \) be the set of all \( k \)-chainlets in \( G \). For a given \( k \)-chainlet \( C_k \in A_k(G) \), the equivalence class of \( C_k \), \( E(C_k) \), is the set of all isomorphic copies (occurrences) of \( C_k \) in \( A_k \).</p>

    <p>Having defined equivalence classes of chainlets, we next define an equivalence class of address nodes for a fixed chainlet class.</p>

    <p><strong>Orbit of an Address Node.</strong> Let \( C_k \) be a \( k \)-chainlet in \( G \), and \( u \) be an address node in \( C_k \). We define the orbit of \( u \) with respect to \( C_k \) as the collection of the images \( \phi(u) \) where \( \phi \) is an isomorphism from \( C_k \) to another \( k \)-chainlet \( C'_k \) in \( G \), i.e.,</p>
    <p style="text-align: center;">\( O_u = \{ \phi(u) \} \).</p>

    <p>We use the notation \( o \) to refer to orbits, e.g., \( o_{15} \) for the orbit 15.</p>

    <h2>Active and Passive Orbits</h2>
    <p>We define an orbit as active or passive based on the role of the associated address within a 2-chainlet.</p>
    <p><strong>Active Orbit.</strong> Let \( C \) be a 2-chainlet. An active orbit with respect to \( C \) is an orbit where its addresses appear as the output of the first and the input of the second transaction in the corresponding occurrence of \( C \). When \( C \) is understood, we denote the set of active orbits as \( O_{\text{act}} \).</p>
    <p>Active orbits indicate behavior created by the address owner, as the address in this orbit initiates a new transaction and sends coins to other addresses.</p>

    <p><strong>Passive Orbit.</strong> Let \( C \) be a 2-chainlet. A passive orbit with respect to \( C \) is an orbit where it appears as the output of the first or the second transaction but not as an input of the second transaction in the corresponding occurrence of \( C \). When \( C \) is understood, we denote the set of passive orbits as \( O_{\text{pass}} \).</p>
    <p>Unlike active orbits, passive orbits for a chainlet class \( E(C) \) receive coins without shaping any occurrences of \( C \), as the address in this orbit only receives coins from another address without initiating a new transaction. It is worth noting that an address can belong to an active orbit for one chainlet class while belonging to a passive orbit for a different chainlet class. This means that an address may exhibit both initiating and receiving behavior in different 2-chainlet types. The below figure provides sample active and passive orbit addresses
in 2-chainlets.</p>

    <figure>
        <img src="figs/active-passive-fig3.png" alt="Active and Passive Orbits Example" style="width: 60%;">
        <figcaption>Sample active and passive orbit addresses in 2-chainlets. Active orbits (striped) show addresses initiating transactions, while passive orbits (checkered) only receive coins.</figcaption>
    </figure>

    <p>The distinction between active and passive orbits is significant for analyzing specific behaviors within the transaction graph. Active orbits help train classifiers to identify spending patterns, such as paying for ransom, as they reflect behavior initiated by the address owner. Conversely, passive orbits are useful for examining receiving behaviors.</p>



    <p>We extend our definition to account-based blockchains by using the temporal order.</p>
</body>
</html>
